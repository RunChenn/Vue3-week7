var S=Object.defineProperty;var I=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var D=(a,e,o)=>e in a?S(a,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[e]=o,C=(a,e)=>{for(var o in e||(e={}))q.call(e,o)&&D(a,o,e[o]);if(I)for(var o of I(e))z.call(e,o)&&D(a,o,e[o]);return a};import{P as F,D as j}from"./DelModal.7ed0504c.js";import{p as b,z as V,M,o as c,b as u,q as t,d as m,A as B,B as L,s as g,v as f,C as A,D as E,G,r as P,e as k,H as w,I as H}from"./vendor.299eaf2a.js";import{a as h}from"./index.1388ebb7.js";import{_ as N}from"./index.483bc275.js";const O={props:{isNew:{type:Boolean,default:!1},product:{type:Object,default:()=>({imagesUrl:{type:Array,default:()=>[]},id:{type:String,default:""}})}},setup(a,{emit:e}){let o=b(null);V(async()=>{o.value=new M(document.getElementById("adminProductModal"),{keyboard:!1})});const s=b(null),_=b(null);return{oneFileInput:s,fileInput:_,upload:async l=>{if(l==="oneImage"){const r=s.value.files[0],v=new FormData;v.append("file-to-upload",r);try{const p=await h.adminProducts.uploadImg(v),{imageUrl:n}=p;a.product.imageUrl=n}catch(p){alert(p.message)}return}a.product.imagesUrl=[];for(let r=0;r<_.value.files.length;r++){const v=new FormData;v.append("file-to-upload",_.value.files[r]);try{const p=await h.adminProducts.uploadImg(v),{imageUrl:n}=p;a.product.imagesUrl.push(n)}catch(p){alert(p.message)}}}}}},i=a=>(E("data-v-3e686dd6"),a=a(),G(),a),T={id:"adminProductModal",ref:"adminProductModal",class:"modal fade text-start",tabindex:"-1","aria-labelledby":"adminProductModalLabel","aria-hidden":"true","data-bs-backdrop":"static","data-bs-keyboard":"false"},J={class:"modal-dialog modal-dialog-scrollable modal-xl"},K={class:"modal-content border-0"},Q={class:"modal-header bg-primary text-white"},R={id:"adminProductModalLabel",class:"modal-title"},W={key:0},X={key:1},Y=i(()=>t("button",{type:"button",class:"btn-close text-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1)),Z={class:"modal-body"},$={class:"row needs-validation",novalidate:""},tt={class:"col-sm-4"},et={class:"mb-3"},ot=i(()=>t("label",{for:"imageUrl",class:"form-label"},"\u4E3B\u8981\u5716\u7247",-1)),lt={class:"mb-3"},at=["src"],st=i(()=>t("h3",{class:"mb-3"},"\u591A\u5716\u65B0\u589E",-1)),nt={class:"mb-3"},dt={key:0},it=["src"],rt={key:1},ct={class:"col-sm-8"},ut={class:"mb-3"},mt=i(()=>t("label",{for:"title",class:"form-label"},"\u6A19\u984C",-1)),pt={class:"row"},bt={class:"mb-3 col-md-6"},gt=i(()=>t("label",{for:"category",class:"form-label"},"\u5206\u985E",-1)),_t={class:"mb-3 col-md-6"},vt=i(()=>t("label",{for:"price",class:"form-label"},"\u55AE\u4F4D",-1)),ft={class:"row"},ht={class:"mb-3 col-md-6"},yt=i(()=>t("label",{for:"origin_price",class:"form-label"},"\u539F\u50F9",-1)),Ut={class:"mb-3 col-md-6"},Pt=i(()=>t("label",{for:"price",class:"form-label"},"\u552E\u50F9",-1)),kt={class:"mb-3"},wt=i(()=>t("label",{for:"price",class:"form-label"},"\u5EAB\u5B58\u6578\u91CF",-1)),Mt=i(()=>t("hr",null,null,-1)),xt={class:"mb-3"},It=i(()=>t("label",{for:"description",class:"form-label"},"\u7522\u54C1\u63CF\u8FF0",-1)),Dt={class:"mb-3"},Ct=i(()=>t("label",{for:"content",class:"form-label"},"\u8AAA\u660E\u5167\u5BB9",-1)),Vt={class:"mb-3"},Bt={class:"form-check"},Lt=i(()=>t("label",{class:"form-check-label",for:"is_enabled"},"\u662F\u5426\u555F\u7528",-1)),Nt={class:"modal-footer"},St=i(()=>t("button",{type:"button",class:"btn btn-outline-danger","data-bs-dismiss":"modal"}," \u53D6\u6D88 ",-1));function qt(a,e,o,s,_,y){return c(),u("div",T,[t("div",J,[t("div",K,[t("div",Q,[t("h5",R,[o.isNew?(c(),u("span",W,"\u65B0\u589E\u7522\u54C1")):(c(),u("span",X,"\u7DE8\u8F2F\u7522\u54C1"))]),Y]),t("div",Z,[t("form",$,[t("div",tt,[t("div",et,[ot,t("div",lt,[m(' <label for="oneFileInput" class="form-label">\u4E0A\u50B3\u5716\u7247</label> '),t("input",{class:"form-control",type:"file",id:"oneFileInput",ref:"oneFileInput",onChange:e[0]||(e[0]=l=>s.upload("oneImage"))},null,544)]),m(` <input
                  v-if="product.imageUrl"
                  v-model="product.imageUrl"
                  type="text"
                  class="form-control mb-2"
                  placeholder="\u8ACB\u8F38\u5165\u5716\u7247\u9023\u7D50"
                  required
                /> `),o.product.imageUrl?(c(),u("img",{key:0,class:"img-fluid",src:o.product.imageUrl},null,8,at)):m("v-if",!0)]),st,t("div",nt,[m(' <label for="fileInput" class="form-label">\u4E0A\u50B3\u5716\u7247</label> '),t("input",{class:"form-control",type:"file",id:"fileInput",ref:"fileInput",multiple:"",onChange:e[1]||(e[1]=l=>s.upload("multipleImage"))},null,544)]),Array.isArray(o.product.imagesUrl)?(c(),u("div",dt,[(c(!0),u(B,null,L(o.product.imagesUrl,l=>(c(),u("div",{class:"mb-1",key:`${l}index`},[m(` <div class="mb-3">
                    <label for="imageUrl" class="form-label">\u5716\u7247\u7DB2\u5740</label>
                    <input
                      v-model="product.imagesUrl[index]"
                      type="text"
                      class="form-control"
                      placeholder="\u8ACB\u8F38\u5165\u5716\u7247\u9023\u7D50"
                    />
                  </div> `),t("img",{class:"img-fluid",src:l},null,8,it)]))),128)),m(` <div
                  v-if="
                    !product.imagesUrl.length ||
                    product.imagesUrl[product.imagesUrl.length - 1]
                  "
                >
                  <button
                    class="btn btn-outline-primary btn-sm d-block w-100"
                    @click="product.imagesUrl.push('')"
                  >
                    \u65B0\u589E\u5716\u7247
                  </button>
                </div>
                <div v-else>
                  <button
                    class="btn btn-outline-danger btn-sm d-block w-100"
                    @click="product.imagesUrl.pop()"
                  >
                    \u522A\u9664\u5716\u7247
                  </button>
                </div> `)])):(c(),u("div",rt,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100",onClick:e[2]||(e[2]=(...l)=>a.createImages&&a.createImages(...l))}," \u65B0\u589E\u5716\u7247 ")]))]),t("div",ct,[t("div",ut,[mt,g(t("input",{id:"title","onUpdate:modelValue":e[3]||(e[3]=l=>o.product.title=l),type:"text",class:"form-control",placeholder:"\u8ACB\u8F38\u5165\u6A19\u984C",required:""},null,512),[[f,o.product.title]])]),t("div",pt,[t("div",bt,[gt,g(t("input",{id:"category","onUpdate:modelValue":e[4]||(e[4]=l=>o.product.category=l),type:"text",class:"form-control",placeholder:"\u8ACB\u8F38\u5165\u5206\u985E",required:""},null,512),[[f,o.product.category]])]),t("div",_t,[vt,g(t("input",{id:"unit","onUpdate:modelValue":e[5]||(e[5]=l=>o.product.unit=l),type:"text",class:"form-control",placeholder:"\u8ACB\u8F38\u5165\u55AE\u4F4D"},null,512),[[f,o.product.unit]])])]),t("div",ft,[t("div",ht,[yt,g(t("input",{id:"origin_price","onUpdate:modelValue":e[6]||(e[6]=l=>o.product.origin_price=l),type:"number",min:"0",class:"form-control",placeholder:"\u8ACB\u8F38\u5165\u539F\u50F9",required:""},null,512),[[f,o.product.origin_price,void 0,{number:!0}]])]),t("div",Ut,[Pt,g(t("input",{id:"price","onUpdate:modelValue":e[7]||(e[7]=l=>o.product.price=l),type:"number",min:"0",class:"form-control",placeholder:"\u8ACB\u8F38\u5165\u552E\u50F9",required:""},null,512),[[f,o.product.price,void 0,{number:!0}]])]),t("div",kt,[wt,g(t("input",{id:"price","onUpdate:modelValue":e[8]||(e[8]=l=>o.product.inventory=l),type:"number",min:"0",class:"form-control",placeholder:"\u8ACB\u8F38\u5165\u5EAB\u5B58\u6578\u91CF",required:""},null,512),[[f,o.product.inventory,void 0,{number:!0}]])]),m(" \u672A\u4F86\u6703\u7528\u5230 "),m(` <div class="mb-3">
                  <div class="form-label">\u5C3A\u5BF8</div>
                  <div
                    class="btn-group"
                    role="group"
                    aria-label="Basic radio toggle button group"
                  >
                    <input
                      type="radio"
                      class="btn-check"
                      name="size"
                      id="size-s"
                      autocomplete="off"
                      v-model="product.size"
                      value="S"
                    />
                    <label class="btn btn-outline-primary" for="size-s"
                      >S</label
                    >
                  </div>
                </div> `)]),Mt,t("div",xt,[It,g(t("textarea",{id:"description","onUpdate:modelValue":e[9]||(e[9]=l=>o.product.description=l),type:"text",class:"form-control",placeholder:"\u8ACB\u8F38\u5165\u7522\u54C1\u63CF\u8FF0"},`
                `,512),[[f,o.product.description]])]),t("div",Dt,[Ct,g(t("textarea",{id:"description","onUpdate:modelValue":e[10]||(e[10]=l=>o.product.content=l),type:"text",class:"form-control",placeholder:"\u8ACB\u8F38\u5165\u8AAA\u660E\u5167\u5BB9"},`
                `,512),[[f,o.product.content]])]),t("div",Vt,[t("div",Bt,[g(t("input",{id:"is_enabled","onUpdate:modelValue":e[11]||(e[11]=l=>o.product.is_enabled=l),class:"form-check-input",type:"checkbox","true-value":1,"false-value":0},null,512),[[A,o.product.is_enabled]]),Lt])])])])]),t("div",Nt,[St,t("button",{type:"button",class:"btn btn-success",onClick:e[12]||(e[12]=l=>a.$emit("update-product",o.product))}," \u78BA\u8A8D ")])])])],512)}var zt=N(O,[["render",qt],["__scopeId","data-v-3e686dd6"]]);const Ft={components:{Pagination:F,ProdModal:zt,DelModal:j},name:"admin-Products",props:["token"],setup(){const a=b(!1),e=b([]),o=b({}),s=b({}),_=b({}),y=b(!1),l=b({imagesUrl:[],id:""});V(async()=>{o.value=new M(document.getElementById("adminProductModal"),{keyboard:!1}),s.value=new M(document.getElementById("delModal"),{keyboard:!1});try{await h.auth.checkAuth(),r()}catch(d){console.log(d),alert(d.message)}});const r=async(d=1)=>{a.value=!0;try{const U=await h.adminProducts.getProducts(d);e.value=U.products,_.value=U.pagination,a.value=!1}catch(U){alert(U.message),a.value=!1}};return{isLoading:a,products:e,product:l,pagination:_,isNew:y,getData:r,openModal:(d,U)=>{y.value=d==="new",l.value=d==="new"?{imagesUrl:[]}:C({},U)},createImages:()=>{l.value.imagesUrl=[],l.value.imagesUrl.push("")},updateProduct:async()=>{if(y.value){try{const d=await h.adminProducts.addProducts({data:l.value});alert(d.message),o.value.hide(),r()}catch(d){alert(d.message)}return}try{const d=await h.adminProducts.updateProducts(l.value.id,{data:l.value});alert(d.message),o.value.hide(),r()}catch(d){alert(d.message)}},delProduct:async()=>{a.value=!0;try{const d=await h.adminProducts.delProducts(l.value.id);alert(d.message),a.value=!1,s.value.hide(),r()}catch(d){alert(d.message),a.value=!1}}}}},jt={class:"container"},At={class:"row py-1"},Et={class:"col-12 col-sm-12"},Gt={class:"text-end mb-3"},Ht={class:"table table-hover mt-4"},Ot=t("thead",null,[t("tr",null,[t("th",{scope:"col"},"\u5206\u985E"),t("th",{scope:"col"},"\u5716\u7247"),t("th",{scope:"col",class:"text-start"},"\u7522\u54C1\u540D\u7A31"),t("th",{scope:"col"},"\u539F\u50F9"),t("th",{scope:"col"},"\u552E\u50F9"),t("th",{scope:"col"},"\u662F\u5426\u555F\u7528"),t("th",{scope:"col"},"\u64CD\u4F5C")])],-1),Tt={style:{width:"200px"}},Jt={class:"text-end"},Kt={class:"text-end"},Qt={key:0,class:"text-success"},Rt={key:1},Wt=["onClick"],Xt=["onClick"];function Yt(a,e,o,s,_,y){const l=P("Loading"),r=P("Pagination"),v=P("ProdModal"),p=P("DelModal");return c(),u("div",jt,[m(" Loading "),k(l,{active:s.isLoading,"onUpdate:active":e[0]||(e[0]=n=>s.isLoading=n),"is-full-page":!0},null,8,["active"]),t("div",At,[t("div",Et,[t("div",Gt,[t("button",{type:"button",class:"btn btn-success",onClick:e[1]||(e[1]=n=>s.openModal("new")),"data-bs-toggle":"modal","data-bs-target":"#adminProductModal"}," \u5EFA\u7ACB\u65B0\u7684\u7522\u54C1 ")]),t("table",Ht,[Ot,t("tbody",null,[(c(!0),u(B,null,L(s.products,n=>(c(),u("tr",{key:n.id},[t("td",null,w(n.category),1),t("td",Tt,[t("div",{style:H([{height:"100px","background-size":"cover","background-position":"center"},{backgroundImage:`url(${n.imageUrl})`}])},null,4)]),t("td",null,w(n.title),1),t("td",Jt,w(n.origin_price),1),t("td",Kt,w(n.price),1),t("td",null,[n.is_enabled?(c(),u("span",Qt,"\u555F\u7528")):(c(),u("span",Rt,"\u672A\u555F\u7528"))]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm me-2 mb-md-1","data-bs-target":"#adminProductModal","data-bs-toggle":"modal",onClick:x=>s.openModal("edit",n)}," \u7DE8\u8F2F ",8,Wt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm me-2 mb-md-1","data-bs-target":"#delModal","data-bs-toggle":"modal",onClick:x=>s.openModal("delete",n)}," \u522A\u9664 ",8,Xt)])]))),128))])])])]),m(' <Pagination :pages="pagination" @emit-pages="getProducts"></Pagination> '),k(r,{pages:s.pagination,"onUpdate:pages":e[2]||(e[2]=n=>s.pagination=n),onUpdatePages:s.getData},null,8,["pages","onUpdatePages"]),m(" Modal "),k(v,{product:s.product,"onUpdate:product":e[3]||(e[3]=n=>s.product=n),"is-new":s.isNew,"onUpdate:is-new":e[4]||(e[4]=n=>s.isNew=n),onUpdateProduct:s.updateProduct},null,8,["product","is-new","onUpdateProduct"]),m(" delModal "),k(p,{ref:"delModal",item:s.product,"onUpdate:item":e[5]||(e[5]=n=>s.product=n),onDelItem:s.delProduct},null,8,["item","onDelItem"])])}var le=N(Ft,[["render",Yt]]);export{le as default};
